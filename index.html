<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>To-Do Online Realtime (Tanpa Login)</title>
  <style>
    :root{
      --bg:#0f1724;--card:#0b1220;--accent:#6ee7b7;--muted:#94a3b8;
      --radius:12px;font-family:Inter,system-ui,sans-serif;
    }
    *{box-sizing:border-box}body{margin:0;min-height:100vh;
      background:linear-gradient(180deg,#07101a,#071a2a);
      color:#e6eef6;display:flex;align-items:center;justify-content:center;
      padding:32px}
    .wrap{width:100%;max-width:720px}
    h1{text-align:center;margin-bottom:16px}
    .card{background:var(--card);padding:18px;border-radius:var(--radius);
      box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    input,button{padding:10px 12px;border-radius:8px;border:none;outline:none}
    input{flex:1;background:rgba(255,255,255,0.05);color:white}
    button{background:linear-gradient(90deg,var(--accent),#60a5fa);
      color:#042024;font-weight:600;cursor:pointer}
    ul{list-style:none;padding:0;margin-top:16px}
    li{display:flex;justify-content:space-between;align-items:center;
      background:rgba(255,255,255,0.05);padding:10px 12px;border-radius:8px;
      margin-bottom:8px}
    li.done span{text-decoration:line-through;opacity:0.6}
    .actions button{background:transparent;border:1px solid rgba(255,255,255,0.1);
      color:var(--muted);padding:6px 10px;font-size:12px}
    footer{text-align:center;color:var(--muted);font-size:13px;margin-top:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>üìù To-Do Online ‚Äî Realtime</h1>
    <div class="card">
      <form id="form">
        <div style="display:flex;gap:8px">
          <input id="taskInput" type="text" placeholder="Tulis tugas baru..." required>
          <button>Tambah</button>
        </div>
      </form>
      <ul id="todoList"></ul>
      <footer>
        Data tersimpan realtime di Firestore ‚Äî semua user berbagi daftar ini.<br>
        <small>Made with ‚ù§Ô∏è + Firebase</small>
      </footer>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    // === 1. Import library Firebase modern (modular) ===
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getFirestore, collection, addDoc, deleteDoc, doc,
             onSnapshot, updateDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

    // === 2. Ganti dengan config project kamu ===
    const firebaseConfig = {
      apiKey: "AIzaSyCdVNx-P4OoemNhx2lTG0LtZIkIAjxQUD0",
      authDomain: "todolist-fdf92.firebaseapp.com",
      projectId: "todolist-fdf92",
      storageBucket: "todolist-fdf92.firebasestorage.app",
      messagingSenderId: "865792443871",
      appId: "1:865792443871:web:c17c9935190fa68623306a",
    };

    // === 3. Inisialisasi Firebase ===
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const todosRef = collection(db, "todos");

    // === 4. Elemen HTML ===
    const form = document.getElementById("form");
    const taskInput = document.getElementById("taskInput");
    const todoList = document.getElementById("todoList");

    // === 5. Tambah to-do ===
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const text = taskInput.value.trim();
      if (!text) return;
      await addDoc(todosRef, { text, done: false, created: Date.now() });
      taskInput.value = "";
    });

    // === 6. Realtime listener ===
    onSnapshot(todosRef, (snapshot) => {
      todoList.innerHTML = "";
      const items = [];
      snapshot.forEach((docu) => {
        items.push({ id: docu.id, ...docu.data() });
      });
      // Urutkan by waktu
      items.sort((a, b) => b.created - a.created);

      for (const t of items) {
        const li = document.createElement("li");
        li.className = t.done ? "done" : "";
        const span = document.createElement("span");
        span.textContent = t.text;
        const act = document.createElement("div");
        act.className = "actions";

        const doneBtn = document.createElement("button");
        doneBtn.textContent = t.done ? "Buka" : "Selesai";
        doneBtn.onclick = async () => {
          await updateDoc(doc(db, "todos", t.id), { done: !t.done });
        };

        const delBtn = document.createElement("button");
        delBtn.textContent = "Hapus";
        delBtn.onclick = async () => {
          await deleteDoc(doc(db, "todos", t.id));
        };

        act.append(doneBtn, delBtn);
        li.append(span, act);
        todoList.appendChild(li);
      }
    });
  </script>
</body>
</html>
